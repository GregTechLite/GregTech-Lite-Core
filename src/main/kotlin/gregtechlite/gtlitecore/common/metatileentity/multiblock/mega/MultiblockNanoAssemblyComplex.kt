package gregtechlite.gtlitecore.common.metatileentity.multiblock.mega

import gregtech.api.capability.impl.EnergyContainerList
import gregtech.api.metatileentity.interfaces.IGregTechTileEntity
import gregtech.api.metatileentity.multiblock.IMultiblockPart
import gregtech.api.metatileentity.multiblock.MultiMapMultiblockController
import gregtech.api.metatileentity.multiblock.MultiblockAbility.INPUT_ENERGY
import gregtech.api.metatileentity.multiblock.MultiblockAbility.INPUT_LASER
import gregtech.api.metatileentity.multiblock.MultiblockAbility.SUBSTATION_INPUT_ENERGY
import gregtech.api.metatileentity.multiblock.RecipeMapMultiblockController
import gregtech.api.pattern.BlockPattern
import gregtech.api.pattern.FactoryBlockPattern
import gregtech.api.recipes.RecipeMaps.ASSEMBLER_RECIPES
import gregtech.api.recipes.logic.OverclockingLogic.PERFECT_DURATION_FACTOR
import gregtech.client.renderer.ICubeRenderer
import gregtechlite.gtlitecore.api.capability.logic.ExtendedPowerMultiblockRecipeLogic
import gregtechlite.gtlitecore.api.recipe.GTLiteRecipeMaps.SINGULARITY_ASSEMBLY_RECIPES
import gregtechlite.gtlitecore.api.recipe.GTLiteRecipeMaps.NANO_ASSEMBLY_MATRIX_RECIPES
import gregtechlite.gtlitecore.api.recipe.GTLiteRecipeMaps.PCB_FACTORY_RECIPES
import gregtechlite.gtlitecore.api.translation.MultiblockTooltipBuilder.Companion.addTooltip
import gregtechlite.gtlitecore.api.translation.mode.OverclockMode
import gregtechlite.gtlitecore.client.renderer.texture.GTLiteOverlays
import gregtechlite.gtlitecore.common.block.adapter.GTGlassCasing
import gregtechlite.gtlitecore.common.block.variant.ActiveUniqueCasing
import gregtechlite.gtlitecore.common.block.variant.GlassCasing
import gregtechlite.gtlitecore.common.block.variant.MetalCasing
import gregtechlite.gtlitecore.common.block.variant.MultiblockCasing
import net.minecraft.item.ItemStack
import net.minecraft.util.ResourceLocation
import net.minecraft.world.World
import net.minecraftforge.fml.relauncher.Side
import net.minecraftforge.fml.relauncher.SideOnly

class MultiblockNanoAssemblyComplex(id: ResourceLocation) : MultiMapMultiblockController(id,
                                                                                         arrayOf(NANO_ASSEMBLY_MATRIX_RECIPES, SINGULARITY_ASSEMBLY_RECIPES, ASSEMBLER_RECIPES, PCB_FACTORY_RECIPES))
{

    init
    {
        recipeMapWorkable = NanoAssemblyComplexRecipeLogic(this)
    }

    companion object
    {
        private val casingState = MetalCasing.LAFIUM.state
        private val secondCasingState = ActiveUniqueCasing.NANO_PRECISE_ASSEMBLY_UNIT.state
        private val thirdCasingState = MultiblockCasing.NANITE_TRANSMISSION_CASING.state
        private val gearboxCasingState = ActiveUniqueCasing.NANITE_CONTROL_CASING.state
        private val coilState = MultiblockCasing.PARTICLE_EXCITATION_WIRE_COIL.state
        private val glassState = GTGlassCasing.FUSION_GLASS.state
        private val secondGlassState = GlassCasing.QUANTUM.state
    }

    override fun createMetaTileEntity(tileEntity: IGregTechTileEntity) = MultiblockNanoAssemblyComplex(metaTileEntityId)

    override fun initializeAbilities()
    {
        super.initializeAbilities()
        val inputEnergy = ArrayList(getAbilities(INPUT_ENERGY))
        inputEnergy.addAll(getAbilities(SUBSTATION_INPUT_ENERGY))
        inputEnergy.addAll(getAbilities(INPUT_LASER))
        energyContainer = EnergyContainerList(inputEnergy)
    }

    // @formatter:off

    override fun createStructurePattern(): BlockPattern = FactoryBlockPattern.start()
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GAAAG    AFG ", "        GAAAG        ", " GFA    GAAAG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GHHHG    AFG ", "        GHCHG        ", " GFA    GHHHG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "         QQQ         ", "        QHHHQ        ", "        QHCHQ        ", "        QHHHQ        ", "         QQQ         ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ", "                     ")
        .aisle("        E   E        ", "       GCG GCG       ", "       FDF FDF       ", "     AAAAA AAAAA     ", "     FDF     FDF     ", "   AFGCG     GCGFA   ", "   ADCE       ECDA   ", " GFAFG         GFAFG ", "ECDA     GGG     ADCE", " GFA    GAAAG    AFG ", "        GASAG        ", " GFA    GAAAG    AFG ", "ECDA     GGG     ADCE", " GFAFG         GFAFG ", "   ADCE       ECDA   ", "   AFGCG     GCGFA   ", "     FDF     FDF     ", "     AAAAA AAAAA     ", "       FDF FDF       ", "       GCG GCG       ", "        E   E        ")
        .where('S', selfPredicate())
        .where('A', states(casingState)
            .setMinGlobalLimited(600)
            .or(autoAbilities(false, false, true, true, true, false, false)))
        .where('E', states(casingState)
            .or(abilities(INPUT_ENERGY)
                    .setPreviewCount(32))
            .or(abilities(INPUT_LASER)
                    .setPreviewCount(0)))
        .where('G', states(secondCasingState))
        .where('C', states(thirdCasingState))
        .where('F', states(glassState))
        .where('Q', states(secondGlassState))
        .where('D', states(gearboxCasingState))
        .where('H', states(coilState))
        .where(' ', any())
        .build()

    // @formatter:on

    @SideOnly(Side.CLIENT)
    override fun getBaseTexture(sourcePart: IMultiblockPart?): ICubeRenderer = GTLiteOverlays.LAFIUM_CASING

    @SideOnly(Side.CLIENT)
    override fun getFrontOverlay(): ICubeRenderer = GTLiteOverlays.NANO_ASSEMBLY_COMPLEX_OVERLAY

    @SideOnly(Side.CLIENT)
    override fun addInformation(stack: ItemStack, player: World?, tooltip: MutableList<String>, advanced: Boolean)
    {
        addTooltip(tooltip)
        {
            addMachineTypeLine()
            addDescriptionLine("gtlitecore.machine.nano_assembly_complex.tooltip.1",
                               "gtlitecore.machine.nano_assembly_complex.tooltip.2",
                               "gtlitecore.machine.nano_assembly_complex.tooltip.3",
                               "gtlitecore.machine.nano_assembly_complex.tooltip.4")
            addOverclockInfo(OverclockMode.PERFECT_DOUBLE)
            addParallelInfo(Int.MAX_VALUE)
            addDescriptionLine("gtlitecore.machine.nano_assembly_complex.tooltip.5")
            addMaxVoltageInfo()
            addLaserHatchInfo()
        }
    }

    override fun canBeDistinct(): Boolean = true

    override fun hasMaintenanceMechanics(): Boolean = false

    private inner class NanoAssemblyComplexRecipeLogic(mte: RecipeMapMultiblockController) : ExtendedPowerMultiblockRecipeLogic(mte)
    {

        override fun getOverclockingDurationFactor() = PERFECT_DURATION_FACTOR / 2

        override fun setMaxProgress(maxProgress: Int)
        {
            maxProgressTime = maxProgress / 4
        }

        override fun getParallelLimit(): Int = Int.MAX_VALUE

    }

}